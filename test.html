<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Agenda Online</title>

<style>
body {
  font-family: Arial, sans-serif;
  padding: 30px;
}

h1 {
  margin-bottom: 30px;
}

button {
  padding: 8px 14px;
  margin: 4px;
  border: 1px solid #999;
  background: #f0f0f0;
  cursor: pointer;
}

button.activo {
  background: #72bd99;
  color: white;
  border-color: #72bd99;
}

.bloque-dia {
  margin-top: 25px;
  padding-top: 15px;
  border-top: 1px solid #ccc;
}

.bloques {
  margin-top: 10px;
}

.bloques button {
  background: #fff;
}
</style>
</head>

<body>

<h1>Agenda Online</h1>

<h3>1Ô∏è‚É£ Eleg√≠ el servicio</h3>

<button onclick="seleccionarServicio(this, 'Facial')">Facial</button>
<button onclick="seleccionarServicio(this, 'Limpieza')">Limpieza</button>
<button onclick="seleccionarServicio(this, 'Corporal')">Corporal</button>

<hr>

<h3>2Ô∏è‚É£ Eleg√≠ horario disponible</h3>

<button onclick="cargarHorarios()">Ver Horarios Disponibles</button>

<div id="agenda"></div>

<script>

let servicioSeleccionado = null;

// üî• TU NUEVO LINK
const API_URL = "https://script.google.com/macros/s/AKfycbyDjyFuWkR23CrVGPh5pbdPpyrtjtdgYFiuVTKeo9wkID5vbtIxlAG_a8nTowAp525A/exec";

function seleccionarServicio(boton, servicio) {

  servicioSeleccionado = servicio;

  document.querySelectorAll("button").forEach(btn => {
    btn.classList.remove("activo");
  });

  boton.classList.add("activo");
}

function cargarHorarios() {

  if (!servicioSeleccionado) {
    alert("Primero eleg√≠ un servicio.");
    return;
  }

  fetch(API_URL + "?action=generarAgenda")
    .then(res => res.json())
    .then(data => {

      const contenedor = document.getElementById("agenda");
      contenedor.innerHTML = "";

      data.forEach(dia => {

        const divDia = document.createElement("div");
        divDia.className = "bloque-dia";

        const titulo = document.createElement("strong");
        titulo.textContent = dia.fecha + " - " + dia.bloquesDisponibles.length + " turnos";

        divDia.appendChild(titulo);

        if (dia.bloquesDisponibles.length > 0) {

          const divBloques = document.createElement("div");
          divBloques.className = "bloques";

          dia.bloquesDisponibles.forEach(b => {

            const btn = document.createElement("button");
            btn.textContent = b.hora;

            divBloques.appendChild(btn);
          });

          divDia.appendChild(divBloques);
        }

        contenedor.appendChild(divDia);
      });

    })
    .catch(err => {
      console.error("Error:", err);
      alert("Error cargando horarios.");
    });
}

</script>

</body>
</html>
