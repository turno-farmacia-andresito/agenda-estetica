<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Agenda Online</title>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 40px;
}

h1 {
  font-size: 32px;
}

.seccion {
  margin-top: 30px;
}

.btn-servicio {
  padding: 8px 18px;
  margin-right: 10px;
  border: 1px solid #999;
  background: #f2f2f2;
  cursor: pointer;
}

.btn-servicio.activo {
  background: #72bd99;
  color: white;
  border-color: #72bd99;
}

.btn-hora {
  padding: 6px 12px;
  margin: 5px;
  border: 1px solid #999;
  background: #f2f2f2;
  cursor: pointer;
}

.btn-hora:hover {
  background: #ddd;
}

hr {
  margin: 20px 0;
}
</style>
</head>

<body>

<h1>Agenda Online</h1>

<div class="seccion">
  <h3>1️⃣ Elegí el servicio</h3>

  <button class="btn-servicio" onclick="seleccionarServicio(this)">Facial</button>
  <button class="btn-servicio" onclick="seleccionarServicio(this)">Limpieza</button>
  <button class="btn-servicio" onclick="seleccionarServicio(this)">Corporal</button>
</div>

<hr>

<div class="seccion">
  <h3>2️⃣ Elegí horario disponible</h3>

  <button onclick="cargarHorarios()">Ver Horarios Disponibles</button>

  <div id="agenda"></div>
</div>

<script>

let servicioSeleccionado = null;

function seleccionarServicio(boton) {
  document.querySelectorAll(".btn-servicio").forEach(btn => {
    btn.classList.remove("activo");
  });

  boton.classList.add("activo");
  servicioSeleccionado = boton.textContent;
}

async function cargarHorarios() {

  if (!servicioSeleccionado) {
    alert("Primero seleccioná un servicio");
    return;
  }

  const url = "https://script.google.com/macros/s/AKfycby-Qok2wEFDNepkx_5NUhclkBK2t2UwRlApSK1ByaDnluGyeCStghmSu4y9G-Bsukwb/exec?action=generarAgenda";

  const respuesta = await fetch(url);
  const datos = await respuesta.json();

  const contenedor = document.getElementById("agenda");
  contenedor.innerHTML = "";

  datos.forEach(dia => {

    const divDia = document.createElement("div");
    divDia.innerHTML = `<h4>${dia.fecha} - ${dia.bloquesDisponibles.length} turnos</h4>`;

    dia.bloquesDisponibles.forEach(bloque => {
      const btn = document.createElement("button");
      btn.className = "btn-hora";
      btn.textContent = bloque.hora;
      divDia.appendChild(btn);
    });

    contenedor.appendChild(divDia);
    contenedor.appendChild(document.createElement("hr"));
  });
}

</script>

</body>
</html>
