<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Agenda Online</title>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 40px;
}

button {
  padding: 6px 10px;
  margin: 3px;
  cursor: pointer;
}

.servicio-btn {
  border: 1px solid #ccc;
  background: #f5f5f5;
}

.servicio-btn.activo {
  background: #72bd99;
  color: white;
  border-color: #72bd99;
}

.hora-btn {
  border: 1px solid #ccc;
  background: #f5f5f5;
}

.hora-btn:hover {
  background: #dff5e8;
}

.dia {
  margin-top: 20px;
  border-top: 1px solid #ddd;
  padding-top: 10px;
}
</style>
</head>

<body>

<h1>Agenda Online</h1>

<h3>1️⃣ Elegí el servicio</h3>

<button class="servicio-btn" onclick="seleccionarServicio('Facial', this)">Facial</button>
<button class="servicio-btn" onclick="seleccionarServicio('Limpieza', this)">Limpieza</button>
<button class="servicio-btn" onclick="seleccionarServicio('Corporal', this)">Corporal</button>

<h3 style="margin-top:30px;">2️⃣ Elegí horario disponible</h3>
<button onclick="cargarHorarios()">Ver Horarios Disponibles</button>

<div id="agenda"></div>

<script>

const API_URL = "https://script.google.com/macros/s/AKfycbzyGRIEu9dYbm2IqD5fE_r9r14wnczacbXM6JY-NrH3vdbbHmfkQ5QopX7oQHl8uSK6/exec?action=generarAgenda";

let servicioSeleccionado = null;

function seleccionarServicio(servicio, boton) {

  servicioSeleccionado = servicio;

  // quitar selección previa
  document.querySelectorAll(".servicio-btn").forEach(btn => {
    btn.classList.remove("activo");
  });

  // marcar seleccionado
  boton.classList.add("activo");
}

async function cargarHorarios() {

  if (!servicioSeleccionado) {
    alert("Primero seleccioná un servicio.");
    return;
  }

  const contenedor = document.getElementById("agenda");
  contenedor.innerHTML = "Cargando...";

  try {

    const response = await fetch(API_URL);
    const data = await response.json();

    contenedor.innerHTML = "";

    data.forEach(dia => {

      const divDia = document.createElement("div");
      divDia.className = "dia";

      const titulo = document.createElement("h4");
      titulo.textContent = dia.fecha + " - " + dia.bloquesDisponibles.length + " turnos";
      divDia.appendChild(titulo);

      dia.bloquesDisponibles.forEach(bloque => {
        const btn = document.createElement("button");
        btn.className = "hora-btn";
        btn.textContent = bloque.hora;
        divDia.appendChild(btn);
      });

      contenedor.appendChild(divDia);
    });

  } catch (error) {
    alert("Error cargando horarios");
    console.error(error);
  }
}

</script>

</body>
</html>
